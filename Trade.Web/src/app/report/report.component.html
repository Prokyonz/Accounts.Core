<app-header [showSideBar]="true" title="{{ PageTitle }}" iconName="pi-arrow-left" leftIconName=""></app-header>
<!-- <app-header (onClickMainIcon)="goBack()" iconName="pi-arrow-left" title="{{ PageTitle }}" leftIconName=""></app-header> -->

<div class="full-screen-card-container" *ngIf="reportIndex == 1">
  <!-- Filter Icon -->
  <div class="filter-icon" (click)="showFilterPopup()">
    <i class="fas fa-filter"></i>
  </div>

  <!-- Filter Modal -->
  <div *ngIf="showFilter">
    <div class="container">
      <!-- Basic Details Card -->
      <div class="panel">
        <div class="card custom-card">
          <p-card>
            <div class="form-content">
              <form>
                <strong>Filter</strong>
                <table class="form-table" [cellSpacing]="5">
                  <tr>
                    <td colspan="2" class="input-field">
                      <label for="name">Customer</label><br />
                      <input id="partyName" name="partyName" pInputText [(ngModel)]="filterCriteria.name" type="text"
                        class="form-control" />
                    </td>
                  </tr>
                  <tr>
                    <td class="half-width">
                      <p-button label="Search" (onClick)="filterSearch()"></p-button>
                    </td>
                    <td class="half-width">
                      <p-button label="Reset" (onClick)="filterCancel()"></p-button>
                    </td>
                  </tr>
                </table>
              </form>
            </div>
          </p-card>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="customers?.length === 0" class="no-data">
    No customers found.
  </div>

  <div *ngFor="let customer of customers" class="customer-card">
    <div class="card-header">
      <strong>Customer ID: </strong>{{ customer.id }}
    </div>
    <div class="card-body">
      <div><strong>{{ customer.firstName }} {{ customer.lastName }}</strong></div>
      <div class="contact-section">
        <i class="fas fa-map-marker-alt icon"></i>
        <span>{{ customer.address }}</span>
      </div>
      <div class="contact-section d-flex">
        <div class="half-width-1">
          <i class="fa fa-mobile-alt icon"></i>
          <span>{{ customer.mobileNo }}</span>
        </div>
        <div class="half-width-1">
          <i class="fas fa-id-card icon"></i>
          <span>{{ customer.panNo }}</span>
        </div>
      </div>
      <div class="icon-container">
        <div class="image-icons">
          <i class="pi pi-image view-icon"
            (click)="imageClick(customer.aadharImageFrontData,'Aadharcard Front', customer.id)" title="Aadharcard Front"
            [ngClass]="{ 'disabled-icon': !customer.aadharImageFrontData }"
            [style.cursor]="customer.aadharImageFrontData ? 'pointer' : 'not-allowed'"
            [attr.aria-disabled]="!customer.aadharImageFrontData"
            [attr.tabindex]="customer.aadharImageFrontData ? '0' : '-1'" style="cursor: pointer;"></i>
          <i class="pi pi-image view-icon"
            (click)="imageClick(customer.aadhbarImageBackData,'Aadharcard Back', customer.id)" title="Aadharcard Back"
            [ngClass]="{ 'disabled-icon': !customer.aadhbarImageBackData }"
            [style.cursor]="customer.aadhbarImageBackData ? 'pointer' : 'not-allowed'"
            [attr.aria-disabled]="!customer.aadhbarImageBackData"
            [attr.tabindex]="customer.aadhbarImageBackData ? '0' : '-1'" style="cursor: pointer;"></i>
          <i class="pi pi-image view-icon" (click)="imageClick(customer.panImageData,'Pancard', customer.id)"
            title="Pancard" [ngClass]="{ 'disabled-icon': !customer.panImageData }"
            [style.cursor]="customer.panImageData ? 'pointer' : 'not-allowed'"
            [attr.aria-disabled]="!customer.panImageData" [attr.tabindex]="customer.panImageData ? '0' : '-1'"
            style="cursor: pointer;"></i>
          <i class="pi pi-image view-icon" (click)="imageClick(customer.signatureImageData,'Signature', customer.id)"
            title="Signature" [ngClass]="{ 'disabled-icon': !customer.signatureImageData }"
            [style.cursor]="customer.signatureImageData ? 'pointer' : 'not-allowed'"
            [attr.aria-disabled]="!customer.signatureImageData"
            [attr.tabindex]="customer.signatureImageData ? '0' : '-1'" style="cursor: pointer;"></i>
        </div>
        <div class="action-icons" *ngIf="isAllowtoEditDelete">
          <i class="pi pi-pencil edit-icon" [routerLink]="['/addcustomer', customer.id ]" title="Edit"
            style="cursor: pointer;"></i>
          <!-- <i class="pi pi-times delete-icon" (click)="deleteItem(customer.id )" title="Delete"
            style="cursor: pointer;"></i> -->
        </div>
      </div>
    </div>
  </div>
</div>

<div class="full-screen-card-container" *ngIf="reportIndex == 2">
  <!-- Filter Icon -->
  <div class="filter-icon" (click)="showFilterPopup()">
    <i class="fas fa-filter"></i>
  </div>

  <!-- Filter Modal -->
  <div *ngIf="showFilter">
    <div class="container">
      <!-- Basic Details Card -->
      <div class="panel">
        <div class="card custom-card">
          <p-card>
            <div class="form-content">
              <form>
                <strong>Filter</strong>
                <table class="form-table" [cellSpacing]="5">
                  <tr>
                    <td colspan="2" class="input-field">
                      <label for="name">User</label><br />
                      <input id="partyName" name="partyName" pInputText [(ngModel)]="filterCriteria.name" type="text"
                        class="form-control" />
                    </td>
                  </tr>
                  <tr>
                    <td class="half-width">
                      <p-button label="Search" (onClick)="filterSearch()"></p-button>
                    </td>
                    <td class="half-width">
                      <p-button label="Reset" (onClick)="filterCancel()"></p-button>
                    </td>
                  </tr>
                </table>
              </form>
            </div>
          </p-card>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="users?.length === 0" class="no-data">
    No users found.
  </div>

  <div *ngFor="let user of users" class="customer-card">
    <div class="card-header">
      <p-checkbox id="isActiveList" [(ngModel)]="user.isActive" name="isActiveList" [binary]="true"
        (onChange)="onCheckChange($event, user)"></p-checkbox>
      <strong>User ID: </strong>{{ user.id }}
    </div>
    <div class="card-body">
      <div><strong>{{ user.firstName }} {{ user.lastName }}</strong></div>

      <!-- Mobile Section with Icon -->
      <div class="contact-section">
        <i class="fa fa-mobile-alt icon"></i> <!-- Font Awesome Mobile Icon -->
        <span>{{ user.mobileNo }}</span>
      </div>

      <!-- Email Section with Icon -->
      <div class="contact-section">
        <i class="fa fa-envelope icon"></i> <!-- Font Awesome Email Icon -->
        <span>{{ user.emailId }}</span>
      </div>

      <div class="action-icons" *ngIf="isAllowtoEditDelete">
        <i class="pi pi-pencil edit-icon" [routerLink]="['/user', user.id ]" title="Edit" style="cursor: pointer;"></i>
        <i class="pi pi-times delete-icon" (click)="deleteItem(user.id )" title="Delete" style="cursor: pointer;"></i>
      </div>
    </div>
  </div>
</div>

<div class="full-screen-card-container" *ngIf="reportIndex == 3"> <!-- Adjust the condition as needed -->
  <!-- Filter Icon -->
  <div class="filter-icon" (click)="showFilterPopup()">
    <i class="fas fa-filter"></i>
  </div>

  <!-- Filter Modal -->
  <div *ngIf="showFilter">
    <div class="container">
      <!-- Basic Details Card -->
      <div class="panel">
        <div class="card custom-card">
          <p-card>
            <div class="form-content">
              <form>
                <strong>Filter</strong>
                <table class="form-table" [cellSpacing]="5">
                  <tr>
                    <td class="half-width">
                      <label for="frmdate">From Date</label>
                      <p-calendar name="fromDate" [(ngModel)]="filterCriteria.fromDate" [showIcon]="true"
                        [touchUI]="true" [readonlyInput]="true"></p-calendar>
                    </td>
                    <td class="half-width">
                      <label for="todate">To Date</label>
                      <p-calendar name="toDate" [(ngModel)]="filterCriteria.toDate" [showIcon]="true" [touchUI]="true"
                        [readonlyInput]="true"></p-calendar>
                    </td>
                  </tr>
                  <tr>
                    <td colspan="2" class="input-field">
                      <label for="name">Dealer</label><br />
                      <input id="partyName" name="partyName" pInputText [(ngModel)]="filterCriteria.name" type="text"
                        class="form-control" />
                    </td>
                  </tr>
                  <tr>
                    <td class="half-width">
                      <p-button label="Search" (onClick)="filterSearch()"></p-button>
                    </td>
                    <td class="half-width">
                      <p-button label="Reset" (onClick)="filterCancel()"></p-button>
                    </td>
                  </tr>
                </table>
              </form>
            </div>
          </p-card>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="purchaseData?.length === 0" class="no-data">
    No purchase data found.
  </div>

  <div *ngFor="let purchase of purchaseData" class="customer-card">
    <div class="card-header">
      <strong>Purchase No: </strong>{{ purchase.invoiceNo }}
    </div>
    <div class="card-body">
      <div><strong>{{ purchase.dealerName }}</strong></div>

      <!-- Bill Amount Section -->
      <div class="details-section">
        <span>{{ purchase.billAmount | currency:'INR' }}</span> <!-- Currency pipe for formatting -->
      </div>

      <div class="details-section">
        <span>{{ purchase.invoiceDate | date }}</span> <!-- Currency pipe for formatting -->
      </div>

      <!-- <div class="action-icons">
        <i class="pi pi-pencil edit-icon" [routerLink]="['/purchase', purchase.id]" title="Edit" style="cursor: pointer;"></i>
        <i class="pi pi-times delete-icon" (click)="deleteItem(purchase.id)" title="Delete" style="cursor: pointer;"></i>
      </div> -->
    </div>
  </div>
</div>

<div class="full-screen-card-container" *ngIf="reportIndex == 4"> <!-- Adjust the condition as needed -->
  <!-- Filter Icon -->
  <div class="filter-icon" (click)="showFilterPopup()">
    <i class="fas fa-filter"></i>
  </div>

  <!-- Filter Modal -->
  <div *ngIf="showFilter">
    <div class="container">
      <!-- Basic Details Card -->
      <div class="panel">
        <div class="card custom-card">
          <p-card>
            <div class="form-content">
              <form>
                <strong>Filter</strong>
                <table class="form-table" [cellSpacing]="5">
                  <tr>
                    <td class="half-width">
                      <label for="frmdate">From Date</label>
                      <p-calendar name="fromDate" [(ngModel)]="filterCriteria.fromDate" [showIcon]="true"
                        [touchUI]="true" [readonlyInput]="true"></p-calendar>
                    </td>
                    <td class="half-width">
                      <label for="todate">To Date</label>
                      <p-calendar name="toDate" [(ngModel)]="filterCriteria.toDate" [showIcon]="true" [touchUI]="true"
                        [readonlyInput]="true"></p-calendar>
                    </td>
                  </tr>
                  <tr>
                    <td colspan="2" class="input-field">
                      <label for="name">Party</label><br />
                      <input id="partyName" name="partyName" pInputText [(ngModel)]="filterCriteria.name" type="text"
                        class="form-control" />
                    </td>
                  </tr>
                  <tr>
                    <td class="half-width">
                      <p-button label="Search" (onClick)="filterSearch()"></p-button>
                    </td>
                    <td class="half-width">
                      <p-button label="Reset" (onClick)="filterCancel()"></p-button>
                    </td>
                  </tr>
                </table>
              </form>
            </div>
          </p-card>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="saleData?.length === 0" class="no-data">
    No sale data found.
  </div>

  <div *ngFor="let group of groupedSaleData" class="customer-card">
    <div class="sale-card-header d-flex justify-content-between align-items-center">
      <strong>{{ group.partyName }}</strong>
      <strong>{{ group.invoiceNo }}</strong>
    </div>
    <div class="card-body">
      <!-- Bill Amount Section -->
      <div class="details-section">
        <span><strong>Bill Amount:</strong> {{ group.billAmount | currency: 'INR' }}</span>
      </div>

      <!-- Invoice Date -->
      <div class="details-section">
        <span><strong>Date:</strong> {{ group.invoiceDate | date: 'shortDate' }}</span>
      </div>

      <!-- Payment Details -->
      <div class="details-section">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th style="width: 12%;">Type</th>
              <th style="width: 25%;">No</th>
              <th style="width: 28%;">Card No</th>
              <th style="width: 35%;">Paid Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let detail of group.details">
              <td>
                <i [class]="detail.paymentMode === 'Cash' ? 'fas fa-money-bill-wave' : 'fas fa-credit-card'"
                  [style.color]="detail.paymentMode === 'Cash' ? 'green' : '#007bff'">
                </i>
              </td>
              <td>{{ detail.paymentNo }}</td>
              <td>{{ detail.cardNo ? detail.cardNo.slice(-4) : '-' }}</td>
              <td>{{ detail.paidAmount | currency: 'INR' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="action-icons">
        <i class="pi pi-eye view-icon" [routerLink]="['/salebill', group.id]" title="View" style="cursor: pointer;"></i>
        <div *ngIf="isAllowtoEditDelete">
          <i class="pi pi-pencil edit-icon" [routerLink]="['/sale', group.id]" title="Edit"
            style="cursor: pointer;"></i>
          <i class="pi pi-times delete-icon" (click)="deleteItem(group.id)" title="Delete" style="cursor: pointer;"></i>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="full-screen-card-container" *ngIf="reportIndex == 5"> <!-- Adjust the condition as needed -->
  <div *ngIf="stockData?.length === 0" class="no-data">
    No stock data found.
  </div>

  <div *ngFor="let stock of stockData" class="customer-card">
    <div class="card-header">
      <strong>Item: </strong>{{ stock.name }}
    </div>
    <div class="card-body">
      <div>
        <strong>Qty: </strong>{{ stock.quantity }}
      </div>

      <div class="details-section">
        <strong>Rate: </strong>{{ stock.rate }}
      </div>

      <div class="details-section">
        <strong>GST: </strong>{{ stock.gstPer }}
      </div>
    </div>
  </div>
</div>

<!-- <div class="full-screen-card-container" *ngIf="reportIndex == 4">
  <div *ngIf="itemData.length === 0" class="no-data">
    No item data found.
  </div>
  
  <div *ngFor="let item of itemData" class="customer-card">
    <div class="card-header">
      {{ item.name }}
    </div>
    <div class="card-body">
      <div><strong>{{ item.description }}</strong></div>
    </div>
  </div>
</div> -->

<p-dialog header="Image" [(visible)]="isImageVisible" [modal]="true" [responsive]="true" (onHide)="onDialogClose()">
  <img *ngIf="imageUrl" [src]="imageUrl" alt="Uploaded Image" style="max-width: 300px; max-height: 300px;" />

  <ng-template pTemplate="footer">
    <div style="display: flex; justify-content: flex-end; align-items: center; width: 100%;">
      <button pButton type="button" icon="pi pi-share-alt" class="p-button-text" (click)="shareImage()"
        style="margin-left: auto;"></button>
    </div>
  </ng-template>
</p-dialog>

<div class="progress-spinner" *ngIf="loading">
  <p-progressSpinner strokeWidth="4" styleClass="w-3rem h-3rem"></p-progressSpinner>
</div>